import pandas as pd
import numpy as np

import math
# import scorecardpy as sc 
import pandas as pd
from sqlalchemy import create_engine
import time
import numpy as np
import datetime
from dateutil.relativedelta import relativedelta
import os, json 
from sqlalchemy import create_engine
from openpyxl import Workbook
from openpyxl.utils import get_column_letter
import pymysql
import pytz,re
import traceback

def applist_variable(order_id):
    
    conn = create_engine('postgresql://BASIC$root:WCjak3$RQnf3ST@8.210.75.205:13343/test')
    sql = '''select 
    order_id,collect_app_name,app_type,collect_app_package,borrow_time, in_time,up_time
    from    
    bengal_test.bd_user_app_info 
    where order_id = '{}';'''.format(order_id)
    
    applist = pd.read_sql_query(sql,conn)
    applist['borrow_time'] = pd.to_datetime(applist['borrow_time'], errors='coerce')
    applist['in_time'] = pd.to_datetime(applist['in_time'], errors='coerce')
    applist['up_time'] = pd.to_datetime(applist['up_time'], errors='coerce')
    applist = applist.dropna(subset=['borrow_time', 'in_time','up_time'])

#  加入新字段， 再按照app 类型分类 ， 做新特征 
    # nagad_words = 'Nagad'
 
    # hospital_words = 'MyGP' 
    # shopping_words = 'Daraz' 
    # docs_words = 'Drive'
    # telecom_words = 'My Robi' or collect_app_package = 'net.omobio.robisc' or imo | 'com.imo.android.imoim' or 'MyBL'| 'com.arena.banglalinkmela.app' or 'My Airtel'| 'net.omobio.airtelsc'
    # entertain_words = ' Toffee' or 'com.banglalink.toffee' | 'CapCut' or 	'com.lemon.lvoverseas'  
    #   金融类  'Rocket'	| 'com.dbbl.mbs.apps.main' 
    #摩的 commute_words = 'Uber' or  'Pathao'| 'com.pathao.user' 
    # job_words= 'LinkedIn|job'
   

    google_words = 'google'
    mail_words= 'mail'
    office_words = 'office'
    xjd_words = 'taka|deposit|แฮปปี้ตัง|installment|loan|cash|credit|kredit|money|สินเชื่อ|เงิน|เครดิต|peso|rupee|dong|Đồng|Vay|Tiền mặt|Tín dụng|ঋণ|লোন|ক্যাশ|নগদ|ক্রেডিট|préstamo|prestamo|crédito|dinero|বিজ্ঞতা ঋণ|แฮปปี้ตัง'
    bank_words = 'bank|ธนาคาร|Ngân hàng|ব্যাংক|banco|bKash|ATM'
    wallet_words = 'wallet|วอลเล็ท|กระเป๋าสตางค์|เป๋าตัง|ถุงเงิน|Ví|billetera|cartera'
    pay_words =  'pay|จ่าย|ชำระ|thanh toán|pago|paga'
    casino_words = 'casino|rummy|คาสิโน|รัมมี่|ดัมมี่|ป๊อกเด้ง|Sòng bạc|cờ bạc'
    fake_words = 'fake'
    


    applist_cnt = applist['collect_app_name'].nunique()
    applist_system_cnt = applist.loc[applist.app_type ==1]['collect_app_name'].nunique()    
    applist_preinstall_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time <= '2019-06-01')]['collect_app_name'].nunique()
    applist_install_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')]['collect_app_name'].nunique()
    applist_update_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)]['collect_app_name'].nunique()
    
    applist_install_google_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(google_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.google', case= False, na = False)))]['collect_app_name'].nunique()
    
    applist_install_mail_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(mail_words, case= False, na = False))|(applist.collect_app_package.str.contains(mail_words, case= False, na = False)))]['collect_app_name'].nunique()
    
    applist_install_office_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(office_words, case= False, na = False))|(applist.collect_app_package.str.contains(office_words, case= False, na = False)))]['collect_app_name'].nunique()
    applist_d0_install_cnt  = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date )]['collect_app_name'].nunique()
    applist_d3_install_cnt  = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))]['collect_app_name'].nunique()
    applist_d7_install_cnt  = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))]['collect_app_name'].nunique()
    applist_d14_install_cnt  = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))]['collect_app_name'].nunique()
    applist_d30_install_cnt  = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))]['collect_app_name'].nunique() 
    applist_d0_update_cnt  = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.up_time.dt.date )&(applist.up_time >applist.in_time )]['collect_app_name'].nunique()
    applist_d3_update_cnt  = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(3,'D'))&(applist.up_time >applist.in_time )]['collect_app_name'].nunique()
    applist_d7_update_cnt  = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(7,'D'))&(applist.up_time >applist.in_time )]['collect_app_name'].nunique()
    applist_d14_update_cnt  = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(14,'D'))&(applist.up_time >applist.in_time )]['collect_app_name'].nunique()
    applist_d30_update_cnt  = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(30,'D'))&(applist.up_time >applist.in_time )]['collect_app_name'].nunique()
    # xjd_words = 'loan|cash|credit|kredit|money|สินเชื่อ|เงิน|เครดิต|peso|rupee|dong|Đồng|Vay|Tiền mặt|Tín dụng|ঋণ|লোন|ক্যাশ|নগদ|ক্রেডিট|préstamo|prestamo|crédito|dinero|Credigen|Rupik|finance|accounting|Kissht|Bajaj Finserv'
    
    applist_install_xjd_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False))]['collect_app_name'].nunique()
    applist_d0_install_xjd_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_xjd_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_xjd_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_xjd_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_xjd_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_update_xjd_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()
    applist_d0_update_xjd_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.up_time.dt.date)&((applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d3_update_xjd_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d7_update_xjd_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d14_update_xjd_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d30_update_xjd_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    
    applist_install_bank_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(bank_words, case= False, na = False))|(applist.collect_app_package.str.contains(bank_words, case= False, na = False)))]['collect_app_name'].nunique()
    applist_d0_install_bank_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains(bank_words, case= False, na = False))|(applist.collect_app_package.str.contains(bank_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_bank_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains(bank_words, case= False, na = False))|(applist.collect_app_package.str.contains(bank_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_bank_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains(bank_words, case= False, na = False))|(applist.collect_app_package.str.contains(bank_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_bank_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains(bank_words, case= False, na = False))|(applist.collect_app_package.str.contains(bank_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_bank_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains(bank_words, case= False, na = False))|(applist.collect_app_package.str.contains(bank_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_update_bank_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(bank_words, case= False, na = False))|(applist.collect_app_package.str.contains(bank_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()
    applist_d0_update_bank_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.up_time.dt.date)&((applist.collect_app_name.str.contains(bank_words, case= False, na = False))|(applist.collect_app_package.str.contains(bank_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d3_update_bank_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains(bank_words, case= False, na = False))|(applist.collect_app_package.str.contains(bank_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d7_update_bank_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains(bank_words, case= False, na = False))|(applist.collect_app_package.str.contains(bank_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d14_update_bank_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains(bank_words, case= False, na = False))|(applist.collect_app_package.str.contains(bank_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d30_update_bank_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains(bank_words, case= False, na = False))|(applist.collect_app_package.str.contains(bank_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    
    applist_install_wallet_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(wallet_words, case= False, na = False))|(applist.collect_app_package.str.contains(wallet_words, case= False, na = False)))]['collect_app_name'].nunique()
    applist_d0_install_wallet_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains(wallet_words, case= False, na = False))|(applist.collect_app_package.str.contains(wallet_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_wallet_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains(wallet_words, case= False, na = False))|(applist.collect_app_package.str.contains(wallet_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_wallet_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains(wallet_words, case= False, na = False))|(applist.collect_app_package.str.contains(wallet_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_wallet_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains(wallet_words, case= False, na = False))|(applist.collect_app_package.str.contains(wallet_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_wallet_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains(wallet_words, case= False, na = False))|(applist.collect_app_package.str.contains(wallet_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_update_wallet_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(wallet_words, case= False, na = False))|(applist.collect_app_package.str.contains(wallet_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()
    applist_d0_update_wallet_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.up_time.dt.date)&((applist.collect_app_name.str.contains(wallet_words, case= False, na = False))|(applist.collect_app_package.str.contains(wallet_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d3_update_wallet_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains(wallet_words, case= False, na = False))|(applist.collect_app_package.str.contains(wallet_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d7_update_wallet_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains(wallet_words, case= False, na = False))|(applist.collect_app_package.str.contains(wallet_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d14_update_wallet_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains(wallet_words, case= False, na = False))|(applist.collect_app_package.str.contains(wallet_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d30_update_wallet_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains(wallet_words, case= False, na = False))|(applist.collect_app_package.str.contains(wallet_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    
    applist_install_pay_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(pay_words, case= False, na = False))|(applist.collect_app_package.str.contains(pay_words, case= False, na = False)))]['collect_app_name'].nunique()
    applist_d0_install_pay_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains(pay_words, case= False, na = False))|(applist.collect_app_package.str.contains(pay_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_pay_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains(pay_words, case= False, na = False))|(applist.collect_app_package.str.contains(pay_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_pay_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains(pay_words, case= False, na = False))|(applist.collect_app_package.str.contains(pay_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_pay_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains(pay_words, case= False, na = False))|(applist.collect_app_package.str.contains(pay_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_pay_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains(pay_words, case= False, na = False))|(applist.collect_app_package.str.contains(pay_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_update_pay_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(pay_words, case= False, na = False))|(applist.collect_app_package.str.contains(pay_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()
    applist_d0_update_pay_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.up_time.dt.date)&((applist.collect_app_name.str.contains(pay_words, case= False, na = False))|(applist.collect_app_package.str.contains(pay_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d3_update_pay_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains(pay_words, case= False, na = False))|(applist.collect_app_package.str.contains(pay_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d7_update_pay_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains(pay_words, case= False, na = False))|(applist.collect_app_package.str.contains(pay_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d14_update_pay_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains(pay_words, case= False, na = False))|(applist.collect_app_package.str.contains(pay_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d30_update_pay_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains(pay_words, case= False, na = False))|(applist.collect_app_package.str.contains(pay_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    
    applist_install_casino_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(casino_words, case= False, na = False))|(applist.collect_app_package.str.contains(casino_words, case= False, na = False)))]['collect_app_name'].nunique()
    applist_d0_install_casino_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains(casino_words, case= False, na = False))|(applist.collect_app_package.str.contains(casino_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_casino_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains(casino_words, case= False, na = False))|(applist.collect_app_package.str.contains(casino_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_casino_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains(casino_words, case= False, na = False))|(applist.collect_app_package.str.contains(casino_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_casino_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains(casino_words, case= False, na = False))|(applist.collect_app_package.str.contains(casino_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_casino_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains(casino_words, case= False, na = False))|(applist.collect_app_package.str.contains(casino_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_update_casino_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(casino_words, case= False, na = False))|(applist.collect_app_package.str.contains(casino_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()
    applist_d0_update_casino_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.up_time.dt.date)&((applist.collect_app_name.str.contains(casino_words, case= False, na = False))|(applist.collect_app_package.str.contains(casino_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d3_update_casino_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains(casino_words, case= False, na = False))|(applist.collect_app_package.str.contains(casino_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d7_update_casino_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains(casino_words, case= False, na = False))|(applist.collect_app_package.str.contains(casino_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d14_update_casino_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains(casino_words, case= False, na = False))|(applist.collect_app_package.str.contains(casino_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()        
    applist_d30_update_casino_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.up_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains(casino_words, case= False, na = False))|(applist.collect_app_package.str.contains(casino_words, case= False, na = False)))&(applist.up_time>applist.in_time)]['collect_app_name'].nunique()      
     
    applist_install_fake_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(fake_words, case= False, na = False))|(applist.collect_app_package.str.contains(fake_words, case= False, na = False)))]['collect_app_name'].nunique()
    applist_d0_install_fake_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains(fake_words, case= False, na = False))|(applist.collect_app_package.str.contains(fake_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_fake_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains(fake_words, case= False, na = False))|(applist.collect_app_package.str.contains(fake_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_fake_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains(fake_words, case= False, na = False))|(applist.collect_app_package.str.contains(fake_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_fake_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains(fake_words, case= False, na = False))|(applist.collect_app_package.str.contains(fake_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_fake_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains(fake_words, case= False, na = False))|(applist.collect_app_package.str.contains(fake_words, case= False, na = False)))]['collect_app_name'].nunique()        
    applist_install_gcash_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('GCash', case= False, na = False))|(applist.collect_app_package.str.contains('com.globe.gcash.android', case= False, na = False)))]['collect_app_name'].nunique()
    applist_d0_install_gcash_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains('GCash', case= False, na = False))|(applist.collect_app_package.str.contains('com.globe.gcash.android', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_gcash_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains('GCash', case= False, na = False))|(applist.collect_app_package.str.contains('com.globe.gcash.android', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_gcash_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains('GCash', case= False, na = False))|(applist.collect_app_package.str.contains('com.globe.gcash.android', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_gcash_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains('GCash', case= False, na = False))|(applist.collect_app_package.str.contains('com.globe.gcash.android', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_gcash_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains('GCash', case= False, na = False))|(applist.collect_app_package.str.contains('com.globe.gcash.android', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_install_maya_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('maya', case= False, na = False))|(applist.collect_app_package.str.contains('com.paymaya', case= False, na = False)))]['collect_app_name'].nunique()
    applist_d0_install_maya_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains('maya', case= False, na = False))|(applist.collect_app_package.str.contains('com.paymaya', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_maya_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains('maya', case= False, na = False))|(applist.collect_app_package.str.contains('com.paymaya', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_maya_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains('maya', case= False, na = False))|(applist.collect_app_package.str.contains('com.paymaya', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_maya_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains('maya', case= False, na = False))|(applist.collect_app_package.str.contains('com.paymaya', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_maya_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains('maya', case= False, na = False))|(applist.collect_app_package.str.contains('com.paymaya', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_install_mabiliscash_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('mabiliscash', case= False, na = False))|(applist.collect_app_package.str.contains('com.loans.lending.onlinelend.mabiliscash', case= False, na = False)))]['collect_app_name'].nunique()
    applist_d0_install_mabiliscash_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains('mabiliscash', case= False, na = False))|(applist.collect_app_package.str.contains('com.loans.lending.onlinelend.mabiliscash', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_mabiliscash_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains('mabiliscash', case= False, na = False))|(applist.collect_app_package.str.contains('com.loans.lending.onlinelend.mabiliscash', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_mabiliscash_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains('mabiliscash', case= False, na = False))|(applist.collect_app_package.str.contains('com.loans.lending.onlinelend.mabiliscash', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_mabiliscash_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains('mabiliscash', case= False, na = False))|(applist.collect_app_package.str.contains('com.loans.lending.onlinelend.mabiliscash', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_mabiliscash_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains('mabiliscash', case= False, na = False))|(applist.collect_app_package.str.contains('com.loans.lending.onlinelend.mabiliscash', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_install_truemoney_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('truemoney', case= False, na = False))|(applist.collect_app_package.str.contains('th.co.truemoney.wallet', case= False, na = False)))]['collect_app_name'].nunique()
    applist_d0_install_truemoney_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains('truemoney', case= False, na = False))|(applist.collect_app_package.str.contains('th.co.truemoney.wallet', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_truemoney_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains('truemoney', case= False, na = False))|(applist.collect_app_package.str.contains('th.co.truemoney.wallet', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_truemoney_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains('truemoney', case= False, na = False))|(applist.collect_app_package.str.contains('th.co.truemoney.wallet', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_truemoney_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains('truemoney', case= False, na = False))|(applist.collect_app_package.str.contains('th.co.truemoney.wallet', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_truemoney_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains('truemoney', case= False, na = False))|(applist.collect_app_package.str.contains('th.co.truemoney.wallet', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_install_scb_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('scb easy', case= False, na = False))|(applist.collect_app_package.str.contains('com.scb.phone', case= False, na = False)))]['collect_app_name'].nunique()
    applist_d0_install_scb_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains('scb easy', case= False, na = False))|(applist.collect_app_package.str.contains('com.scb.phone', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_scb_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains('scb easy', case= False, na = False))|(applist.collect_app_package.str.contains('com.scb.phone', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_scb_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains('scb easy', case= False, na = False))|(applist.collect_app_package.str.contains('com.scb.phone', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_scb_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains('scb easy', case= False, na = False))|(applist.collect_app_package.str.contains('com.scb.phone', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_scb_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains('scb easy', case= False, na = False))|(applist.collect_app_package.str.contains('com.scb.phone', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_install_momo_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('momo', case= False, na = False))|(applist.collect_app_package.str.contains('com.mservice.momotransfer', case= False, na = False)))]['collect_app_name'].nunique()
    applist_d0_install_momo_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains('momo', case= False, na = False))|(applist.collect_app_package.str.contains('com.mservice.momotransfer', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_momo_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains('momo', case= False, na = False))|(applist.collect_app_package.str.contains('com.mservice.momotransfer', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_momo_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains('momo', case= False, na = False))|(applist.collect_app_package.str.contains('com.mservice.momotransfer', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_momo_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains('momo', case= False, na = False))|(applist.collect_app_package.str.contains('com.mservice.momotransfer', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_momo_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains('momo', case= False, na = False))|(applist.collect_app_package.str.contains('com.mservice.momotransfer', case= False, na = False)))]['collect_app_name'].nunique()        
    
    applist_install_facebook_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('facebook', case= False, na = False))|(applist.collect_app_package.str.contains('com.facebook.katana', case= False, na = False)))]['collect_app_name'].nunique()
    applist_d0_install_facebook_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains('facebook', case= False, na = False))|(applist.collect_app_package.str.contains('com.facebook.katana', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_facebook_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains('facebook', case= False, na = False))|(applist.collect_app_package.str.contains('com.facebook.katana', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_facebook_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains('facebook', case= False, na = False))|(applist.collect_app_package.str.contains('com.facebook.katana', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_facebook_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains('facebook', case= False, na = False))|(applist.collect_app_package.str.contains('com.facebook.katana', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_facebook_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains('facebook', case= False, na = False))|(applist.collect_app_package.str.contains('com.facebook.katana', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_install_messenger_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('messenger', case= False, na = False))|(applist.collect_app_package.str.contains('com.facebook.orca', case= False, na = False)))]['collect_app_name'].nunique()
    applist_d0_install_messenger_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains('messenger', case= False, na = False))|(applist.collect_app_package.str.contains('com.facebook.orca', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_messenger_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains('messenger', case= False, na = False))|(applist.collect_app_package.str.contains('com.facebook.orca', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_messenger_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains('messenger', case= False, na = False))|(applist.collect_app_package.str.contains('com.facebook.orca', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_messenger_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains('messenger', case= False, na = False))|(applist.collect_app_package.str.contains('com.facebook.orca', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_messenger_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains('messenger', case= False, na = False))|(applist.collect_app_package.str.contains('com.facebook.orca', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_install_instagram_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('instagram', case= False, na = False))|(applist.collect_app_package.str.contains('com.instagram.android', case= False, na = False)))]['collect_app_name'].nunique()
    applist_d0_install_instagram_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains('instagram', case= False, na = False))|(applist.collect_app_package.str.contains('com.instagram.android', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_instagram_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains('instagram', case= False, na = False))|(applist.collect_app_package.str.contains('com.instagram.android', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_instagram_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains('instagram', case= False, na = False))|(applist.collect_app_package.str.contains('com.instagram.android', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_instagram_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains('instagram', case= False, na = False))|(applist.collect_app_package.str.contains('com.instagram.android', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_instagram_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains('instagram', case= False, na = False))|(applist.collect_app_package.str.contains('com.instagram.android', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_install_telegram_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('telegram', case= False, na = False))|(applist.collect_app_package.str.contains('org.telegram.messenger', case= False, na = False)))]['collect_app_name'].nunique()
    applist_d0_install_telegram_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains('telegram', case= False, na = False))|(applist.collect_app_package.str.contains('org.telegram.messenger', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_telegram_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains('telegram', case= False, na = False))|(applist.collect_app_package.str.contains('org.telegram.messenger', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_telegram_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains('telegram', case= False, na = False))|(applist.collect_app_package.str.contains('org.telegram.messenger', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_telegram_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains('telegram', case= False, na = False))|(applist.collect_app_package.str.contains('org.telegram.messenger', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_telegram_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains('telegram', case= False, na = False))|(applist.collect_app_package.str.contains('org.telegram.messenger', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_install_whatsapp_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('whatsapp', case= False, na = False))|(applist.collect_app_package.str.contains('com.whatsapp', case= False, na = False)))]['collect_app_name'].nunique()
    applist_d0_install_whatsapp_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains('whatsapp', case= False, na = False))|(applist.collect_app_package.str.contains('com.whatsapp', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_whatsapp_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains('whatsapp', case= False, na = False))|(applist.collect_app_package.str.contains('com.whatsapp', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_whatsapp_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains('whatsapp', case= False, na = False))|(applist.collect_app_package.str.contains('com.whatsapp', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_whatsapp_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains('whatsapp', case= False, na = False))|(applist.collect_app_package.str.contains('com.whatsapp', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_whatsapp_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains('whatsapp', case= False, na = False))|(applist.collect_app_package.str.contains('com.whatsapp', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_install_zalo_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('zalo', case= False, na = False))|(applist.collect_app_package.str.contains('com.zing.zalo', case= False, na = False)))]['collect_app_name'].nunique()
    applist_d0_install_zalo_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains('zalo', case= False, na = False))|(applist.collect_app_package.str.contains('com.zing.zalo', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_zalo_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains('zalo', case= False, na = False))|(applist.collect_app_package.str.contains('com.zing.zalo', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_zalo_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains('zalo', case= False, na = False))|(applist.collect_app_package.str.contains('com.zing.zalo', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_zalo_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains('zalo', case= False, na = False))|(applist.collect_app_package.str.contains('com.zing.zalo', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_zalo_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains('zalo', case= False, na = False))|(applist.collect_app_package.str.contains('com.zing.zalo', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_install_tiktok_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('tiktok', case= False, na = False))|(applist.collect_app_package.str.contains('com.ss.android.ugc.trill', case= False, na = False)))]['collect_app_name'].nunique()
    applist_d0_install_tiktok_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains('tiktok', case= False, na = False))|(applist.collect_app_package.str.contains('com.ss.android.ugc.trill', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_tiktok_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains('tiktok', case= False, na = False))|(applist.collect_app_package.str.contains('com.ss.android.ugc.trill', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_tiktok_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains('tiktok', case= False, na = False))|(applist.collect_app_package.str.contains('com.ss.android.ugc.trill', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_tiktok_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains('tiktok', case= False, na = False))|(applist.collect_app_package.str.contains('com.ss.android.ugc.trill', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_tiktok_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains('tiktok', case= False, na = False))|(applist.collect_app_package.str.contains('com.ss.android.ugc.trill', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_install_imported_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name == applist.collect_app_package)]['collect_app_name'].nunique()
    
    applist_d0_install_imported_cnt  = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date )&(applist.collect_app_name == applist.collect_app_package)]['collect_app_name'].nunique()
    applist_d3_install_imported_cnt  = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&(applist.collect_app_name == applist.collect_app_package)]['collect_app_name'].nunique()
    applist_d7_install_imported_cnt  = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&(applist.collect_app_name == applist.collect_app_package)]['collect_app_name'].nunique()
    applist_d14_install_imported_cnt  = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&(applist.collect_app_name == applist.collect_app_package)]['collect_app_name'].nunique()
    applist_d30_install_imported_cnt  = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&(applist.collect_app_name == applist.collect_app_package)]['collect_app_name'].nunique() 
    
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')].empty:
        applist_install_date_max_gap =-1
    else:
        applist_install_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')]['in_time'].dt.date).apply(lambda x: x.days))
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False))].empty:
        applist_install_xjd_date_max_gap= -1
    else:
        applist_install_xjd_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False)))]['borrow_time'].dt.date -applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False)))]['in_time'].dt.date).apply(lambda x: x.days))
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains(bank_words, case= False, na = False))|(applist.collect_app_package.str.contains(bank_words, case= False, na = False))].empty:
        applist_install_bank_date_max_gap= -1
    else:
        applist_install_bank_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(bank_words, case= False, na = False))|(applist.collect_app_package.str.contains(bank_words, case= False, na = False)))]['borrow_time'].dt.date -applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(bank_words, case= False, na = False))|(applist.collect_app_package.str.contains(bank_words, case= False, na = False)))]['in_time'].dt.date).apply(lambda x: x.days))
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(wallet_words, case= False, na = False))|(applist.collect_app_package.str.contains(wallet_words, case= False, na = False)))].empty:
        applist_install_wallet_date_max_gap= -1
    else:
        applist_install_wallet_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(wallet_words, case= False, na = False))|(applist.collect_app_package.str.contains(wallet_words, case= False, na = False)))]['borrow_time'].dt.date -applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(wallet_words, case= False, na = False))|(applist.collect_app_package.str.contains(wallet_words, case= False, na = False)))]['in_time'].dt.date).apply(lambda x: x.days))
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(pay_words, case= False, na = False))|(applist.collect_app_package.str.contains(pay_words, case= False, na = False)))].empty:
        applist_install_pay_date_max_gap= -1
    else:
        applist_install_pay_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(pay_words, case= False, na = False))|(applist.collect_app_package.str.contains(pay_words, case= False, na = False)))]['borrow_time'].dt.date -applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(pay_words, case= False, na = False))|(applist.collect_app_package.str.contains(pay_words, case= False, na = False)))]['in_time'].dt.date).apply(lambda x: x.days))
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains(casino_words, case= False, na = False))|(applist.collect_app_package.str.contains(casino_words, case= False, na = False))].empty:
        applist_install_casino_date_max_gap= -1
    else:
        applist_install_casino_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(casino_words, case= False, na = False))|(applist.collect_app_package.str.contains(casino_words, case= False, na = False)))]['borrow_time'].dt.date -applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(casino_words, case= False, na = False))|(applist.collect_app_package.str.contains(casino_words, case= False, na = False)))]['in_time'].dt.date).apply(lambda x: x.days))
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)].empty:
        applist_update_date_max_gap =-1
    else:
        applist_update_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)]['up_time'].dt.date).apply(lambda x: x.days))
    
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&(applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False))].empty or applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False)))]['borrow_time'].empty or applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False)))]['up_time'].empty:
        applist_update_xjd_date_max_gap =-1
    else:
        applist_update_xjd_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False)))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&(applist.collect_app_name.str.contains(xjd_words, case= False, na = False))|(applist.collect_app_package.str.contains(xjd_words, case= False, na = False))]['up_time'].dt.date).apply(lambda x: x.days))
    # print(order_id,applist_update_xjd_date_max_gap)
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains(bank_words, case= False, na = False))|(applist.collect_app_package.str.contains(bank_words, case= False, na = False)))].empty:
        applist_update_bank_date_max_gap =-1
    else:
        applist_update_bank_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains(bank_words, case= False, na = False))|(applist.collect_app_package.str.contains(bank_words, case= False, na = False)))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&(applist.collect_app_name.str.contains(bank_words, case= False, na = False))|(applist.collect_app_package.str.contains(bank_words, case= False, na = False))]['up_time'].dt.date).apply(lambda x: x.days))
   
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains(wallet_words, case= False, na = False))|(applist.collect_app_package.str.contains(wallet_words, case= False, na = False)))].empty:
        applist_update_wallet_date_max_gap =-1
    else:
        applist_update_wallet_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains(wallet_words, case= False, na = False))|(applist.collect_app_package.str.contains(wallet_words, case= False, na = False)))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains(wallet_words, case= False, na = False))|(applist.collect_app_package.str.contains(wallet_words, case= False, na = False)))]['up_time'].dt.date).apply(lambda x: x.days))

    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains(pay_words, case= False, na = False))|(applist.collect_app_package.str.contains(pay_words, case= False, na = False)))].empty:
        applist_update_pay_date_max_gap =-1
    else:
        applist_update_pay_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains(pay_words, case= False, na = False))|(applist.collect_app_package.str.contains(pay_words, case= False, na = False)))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains(pay_words, case= False, na = False))|(applist.collect_app_package.str.contains(pay_words, case= False, na = False)))]['up_time'].dt.date).apply(lambda x: x.days))
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&(applist.collect_app_name.str.contains(casino_words, case= False, na = False))|(applist.collect_app_package.str.contains(casino_words, case= False, na = False))].empty:
        applist_update_casino_date_max_gap =-1
    else:
        applist_update_casino_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&(applist.collect_app_name.str.contains(casino_words, case= False, na = False))|(applist.collect_app_package.str.contains(casino_words, case= False, na = False))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&(applist.collect_app_name.str.contains(casino_words, case= False, na = False))|(applist.collect_app_package.str.contains(casino_words, case= False, na = False))]['up_time'].dt.date).apply(lambda x: x.days))
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('whatsapp', case= False, na = False))].empty:
        applist_install_whatsapp_date_max_gap= -1
    else:
        applist_install_whatsapp_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('whatsapp', case= False, na = False))]['borrow_time'].dt.date -applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('whatsapp', case= False, na = False)) ]['in_time'].dt.date).apply(lambda x: x.days))
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('facebook', case= False, na = False))|(applist.collect_app_package.str.contains('facebook', case= False, na = False)))].empty:
        applist_install_facebook_date_max_gap= -1
    else:
        applist_install_facebook_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('facebook', case= False, na = False))|(applist.collect_app_package.str.contains('facebook', case= False, na = False)))]['borrow_time'].dt.date -applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('facebook', case= False, na = False))|(applist.collect_app_package.str.contains('facebook', case= False, na = False)))]['in_time'].dt.date).apply(lambda x: x.days))
        
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('messenger', case= False, na = False))|(applist.collect_app_package.str.contains('messenger', case= False, na = False)))].empty:
        applist_install_messenger_date_max_gap= -1
    else:
        applist_install_messenger_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('messenger', case= False, na = False))|(applist.collect_app_package.str.contains('messenger', case= False, na = False)))]['borrow_time'].dt.date -applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('messenger', case= False, na = False))|(applist.collect_app_package.str.contains('messenger', case= False, na = False)))]['in_time'].dt.date).apply(lambda x: x.days))
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('telegram', case= False, na = False))].empty:
        applist_install_telegram_date_max_gap= -1
    else:
        applist_install_telegram_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('telegram', case= False, na = False))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('telegram', case= False, na = False))]['in_time'].dt.date).apply(lambda x: x.days))
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('wechat', case= False, na = False))].empty:
        applist_install_wechat_date_max_gap= -1
    else:
        applist_install_wechat_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('wechat', case= False, na = False))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('wechat', case= False, na = False))]['in_time'].dt.date).apply(lambda x: x.days))
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('instagram', case= False, na = False))].empty:
        applist_install_instagram_date_max_gap= -1
    else:
        applist_install_instagram_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('instagram', case= False, na = False))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('instagram', case= False, na = False))]['in_time'].dt.date).apply(lambda x: x.days))
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('tiktok', case= False, na = False))].empty:
        applist_install_tiktok_date_max_gap= -1
    else:
        applist_install_tiktok_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('tiktok', case= False, na = False))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('tiktok', case= False, na = False))]['in_time'].dt.date).apply(lambda x: x.days))
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_package.str.contains('com.truecaller', case= False, na = False))].empty:
        applist_install_truecaller_date_max_gap= -1
    else:
        applist_install_truecaller_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_package.str.contains('com.truecaller', case= False, na = False))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_package.str.contains('com.truecaller', case= False, na = False))]['in_time'].dt.date).apply(lambda x: x.days))
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_package.str.contains('com.shopee', case= False, na = False))].empty:
        applist_install_shopee_date_max_gap= -1
    else:
        applist_install_shopee_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_package.str.contains('com.shopee', case= False, na = False))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_package.str.contains('com.shopee', case= False, na = False))]['in_time'].dt.date).apply(lambda x: x.days))
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('lazada', case= False, na = False))].empty:
        applist_install_lazada_date_max_gap= -1
    else:
        applist_install_lazada_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('lazada', case= False, na = False))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('lazada', case= False, na = False))]['in_time'].dt.date).apply(lambda x: x.days))
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('flipkart', case= False, na = False))].empty:
        applist_install_flipkart_date_max_gap= -1
    else:
        applist_install_flipkart_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('flipkart', case= False, na = False))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('flipkart', case= False, na = False))]['in_time'].dt.date).apply(lambda x: x.days))
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('grabfood', case= False, na = False))].empty:
        applist_install_grabfood_date_max_gap= -1
    else:
        applist_install_grabfood_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('grabfood', case= False, na = False))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('grabfood', case= False, na = False))]['in_time'].dt.date).apply(lambda x: x.days))
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('swiggy', case= False, na = False))].empty:
        applist_install_swiggy_date_max_gap= -1
    else:
        applist_install_swiggy_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('swiggy', case= False, na = False))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('swiggy', case= False, na = False))]['in_time'].dt.date).apply(lambda x: x.days))
    applist_is_install_gmail = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('gmail', case= False, na = False))).any()) 
    applist_is_install_yahoomail = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('yahoo mail', case= False, na = False))).any()) 
    applist_is_install_facebook = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('facebook', case= False, na = False))|(applist.collect_app_package.str.contains('facebook', case= False, na = False)))).any()) 
    applist_is_install_messenger = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('messenger', case= False, na = False))|applist.collect_app_package.str.contains('messenger',case= False,na = False))).any()) 
    applist_is_install_whatsapp = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('whatsapp', case= False, na = False))).any()) 
    applist_is_install_telegram = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('telegram', case= False, na = False))).any()) 
    applist_is_install_wechat = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('wechat', case= False, na = False))).any()) 
    applist_is_install_instagram = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('instagram', case= False, na = False))).any()) 
    applist_is_install_tiktok = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('tiktok', case= False, na = False))).any()) 
    applist_is_install_truecaller = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_package.str.contains('com.truecaller', case= False, na = False))).any()) 
    applist_is_install_shopee = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_package.str.contains('com.shopee', case= False, na = False))).any()) 
    applist_is_install_lazada = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('lazada', case= False, na = False))).any()) 
    applist_is_install_flipkart = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('flipkart', case= False, na = False))).any()) 
    applist_is_install_foodpanda = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('foodpanda', case= False, na = False))).any()) 
    applist_is_install_zomato = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('zomato', case= False, na = False))).any()) 
    applist_is_install_swiggy = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('swiggy', case= False, na = False))).any()) 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('gmail', case= False, na = False))].empty:
        applist_is_update_gmail = -1 
    else:
        applist_is_update_gmail = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('gmail', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('yahoo mail', case= False, na = False))].empty:
        applist_is_update_yahoomail = -1 
    else:
        applist_is_update_yahoomail = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('yahoo mail', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_package.str.contains('com.microsoft.office', case= False, na = False))].empty:
        applist_is_update_microffice = -1 
    else:
        applist_is_update_microffice = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_package.str.contains('com.microsoft.office', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_package.str.contains('cn.wps', case= False, na = False))].empty:
        applist_is_update_wpsoffice = -1 
    else:
        applist_is_update_wpsoffice = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_package.str.contains('cn.wps', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('whatsapp', case= False, na = False))].empty:
        applist_is_update_whatsapp = -1 
    else:
        applist_is_update_whatsapp = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('whatsapp', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('telegram', case= False, na = False))].empty:
        applist_is_update_telegram = -1 
    else:
        applist_is_update_telegram = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('telegram', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('wechat', case= False, na = False))].empty:
        applist_is_update_wechat = -1 
    else:
        applist_is_update_wechat = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('wechat', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('instagram', case= False, na = False))].empty:
        applist_is_update_instagram = -1 
    else:
        applist_is_update_instagram = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('instagram', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('tiktok', case= False, na = False))].empty:
        applist_is_update_tiktok = -1 
    else:
        applist_is_update_tiktok = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('tiktok', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_package.str.contains('com.shopee', case= False, na = False))].empty:
        applist_is_update_shopee = -1 
    else:
        applist_is_update_shopee = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_package.str.contains('com.shopee', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('lazada', case= False, na = False))].empty:
        applist_is_update_lazada = -1 
    else:
        applist_is_update_lazada = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('lazada', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('flipkart', case= False, na = False))].empty:
        applist_is_update_flipkart = -1 
    else:
        applist_is_update_flipkart = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('flipkart', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('grabfood', case= False, na = False))].empty:
        applist_is_update_grabfood = -1 
    else:
        applist_is_update_grabfood = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('grabfood', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('foodpanda', case= False, na = False))].empty:
        applist_is_update_foodpanda = -1 
    else:
        applist_is_update_foodpanda = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('foodpanda', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('zomato', case= False, na = False))].empty:
        applist_is_update_zomato = -1 
    else:
        applist_is_update_zomato = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('zomato', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('swiggy', case= False, na = False))].empty:
        applist_is_update_swiggy = -1 
    else:
        applist_is_update_swiggy = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('swiggy', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')].empty:
        applist_daily_max = -1 
    else:
        applist_daily_max = np.max(applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')].groupby((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')]['in_time'].dt.date).dt.days)['collect_app_name'].nunique())     
    
    if applist.empty:
        applist_d0_daily_max= applist_d3_daily_max = applist_d7_daily_max = applist_d14_daily_max = applist_d30_daily_max = -1 

    else:
        applist['time_diff'] = (applist['borrow_time'].dt.date - applist['in_time'].dt.date).dt.days
        applist_d0_daily_max = np.max(applist.loc[(applist.app_type == 0) & (applist.in_time > '2019-06-01') & (applist.time_diff == 0),'collect_app_name'].nunique())
        applist_d3_daily_max  = np.max(applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')& (applist['time_diff'] <=3)].groupby('time_diff')['collect_app_name'].nunique())

        applist_d7_daily_max  = np.max(applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')& (applist['time_diff'] <=7)].groupby('time_diff')['collect_app_name'].nunique())
 
        applist_d14_daily_max  = np.max(applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')& (applist['time_diff'] <=14)].groupby('time_diff')['collect_app_name'].nunique())
 
        applist_d30_daily_max  = np.max(applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')& (applist['time_diff'] <= 30)].groupby('time_diff')['collect_app_name'].nunique())
    
    applist_install_nagad_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('Nagad', case= False, na = False))|(applist.collect_app_package.str.contains('com.konasl.nagad', case= False, na = False)))]['collect_app_name'].nunique() 
    applist_d0_install_nagad_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains('Nagad', case= False, na = False))|(applist.collect_app_package.str.contains('com.konasl.nagad', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_nagad_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains('Nagad', case= False, na = False))|(applist.collect_app_package.str.contains('com.konasl.nagad', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_nagad_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains('Nagad', case= False, na = False))|(applist.collect_app_package.str.contains('com.konasl.nagad', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_nagad_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains('Nagad', case= False, na = False))|(applist.collect_app_package.str.contains('com.konasl.nagad', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_nagad_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains('Nagad', case= False, na = False))|(applist.collect_app_package.str.contains('com.konasl.nagad', case= False, na = False)))]['collect_app_name'].nunique()        


    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('nagad', case= False, na = False))|(applist.collect_app_package.str.contains('nagad', case= False, na = False))].empty:
        applist_install_nagad_date_max_gap= -1
    else:
        applist_install_nagad_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('nagad', case= False, na = False))|(applist.collect_app_package.str.contains('com.konasl.nagad', case= False, na = False)))]['borrow_time'].dt.date -applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('nagad', case= False, na = False))|(applist.collect_app_package.str.contains('com.konasl.nagad', case= False, na = False)))]['in_time'].dt.date).apply(lambda x: x.days))

    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('Nagad', case= False, na = False))].empty:
        applist_is_update_nagad = -1 
    else:
        applist_is_update_nagad = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('Nagad', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 

    applist_is_install_nagad = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('Nagad', case= False, na = False))|(applist.collect_app_package.str.contains('com.konasl.nagad', case= False, na = False)))).any()) 
   
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains('nagad', case= False, na = False))|(applist.collect_app_package.str.contains('com.konasl.nagad', case= False, na = False)))].empty:
        applist_update_nagad_date_max_gap =-1
    else:
        applist_update_nagad_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains('nagad', case= False, na = False))|(applist.collect_app_package.str.contains('com.konasl.nagad', case= False, na = False)))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains('nagad', case= False, na = False))|(applist.collect_app_package.str.contains('com.konasl.nagad', case= False, na = False)))]['up_time'].dt.date).apply(lambda x: x.days))


    applist_install_hospital_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('MyGP', case= False, na = False))|(applist.collect_app_package.str.contains('com.portonics.mygp', case= False, na = False)))]['collect_app_name'].nunique() 
    applist_d0_install_hospital_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains('MyGP', case= False, na = False))|(applist.collect_app_package.str.contains('com.portonics.mygp', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_hospital_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains('MyGP', case= False, na = False))|(applist.collect_app_package.str.contains('com.portonics.mygp', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_hospital_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains('MyGP', case= False, na = False))|(applist.collect_app_package.str.contains('com.portonics.mygp', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_hospital_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains('MyGP', case= False, na = False))|(applist.collect_app_package.str.contains('com.portonics.mygp', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_hospital_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains('MyGP', case= False, na = False))|(applist.collect_app_package.str.contains('com.portonics.mygp', case= False, na = False)))]['collect_app_name'].nunique()        

 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('MyGP', case= False, na = False))|(applist.collect_app_package.str.contains('MyGP', case= False, na = False))].empty:
        applist_install_hospital_date_max_gap= -1
    else:
        applist_install_hospital_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('MyGP', case= False, na = False))|(applist.collect_app_package.str.contains('com.portonics.mygp', case= False, na = False)))]['borrow_time'].dt.date -applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('MyGP', case= False, na = False))|(applist.collect_app_package.str.contains('com.portonics.mygp', case= False, na = False)))]['in_time'].dt.date).apply(lambda x: x.days))

    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('MyGP', case= False, na = False))].empty:
        applist_is_update_mygp = -1 
    else:
        applist_is_update_mygp = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('MyGP', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 

    applist_is_install_mygp = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('MyGP', case= False, na = False))|(applist.collect_app_package.str.contains('com.portonics.mygp', case= False, na = False)))).any()) 
   
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains('MyGP', case= False, na = False))|(applist.collect_app_package.str.contains('com.portonics.mygp', case= False, na = False)))].empty:
        applist_update_hospital_date_max_gap =-1
    else:
        applist_update_hospital_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains('MyGP', case= False, na = False))|(applist.collect_app_package.str.contains('com.portonics.mygp', case= False, na = False)))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains('MyGP', case= False, na = False))|(applist.collect_app_package.str.contains('com.portonics.mygp', case= False, na = False)))]['up_time'].dt.date).apply(lambda x: x.days))
    applist_install_shopping_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['collect_app_name'].nunique() 
    applist_d0_install_shopping_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_shopping_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_shopping_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_shopping_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_shopping_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['collect_app_name'].nunique()        

 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('daraz', case= False, na = False))].empty:
        applist_install_shopping_date_max_gap= -1
    else:
        applist_install_shopping_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['borrow_time'].dt.date -applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['in_time'].dt.date).apply(lambda x: x.days))

    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('daraz', case= False, na = False))].empty:
        applist_is_update_daraz = -1 
    else:
        applist_is_update_daraz = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('daraz', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 

    applist_is_install_daraz = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))).any()) 
   
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))].empty:
        applist_update_shopping_date_max_gap =-1
    else:
        applist_update_shopping_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['up_time'].dt.date).apply(lambda x: x.days))

    applist_install_shopping_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['collect_app_name'].nunique() 
    applist_d0_install_shopping_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_shopping_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_shopping_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_shopping_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_shopping_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['collect_app_name'].nunique()        

 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('daraz', case= False, na = False))].empty:
        applist_install_shopping_date_max_gap= -1
    else:
        applist_install_shopping_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['borrow_time'].dt.date -applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['in_time'].dt.date).apply(lambda x: x.days))

    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('daraz', case= False, na = False))].empty:
        applist_is_update_daraz = -1 
    else:
        applist_is_update_daraz = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('daraz', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 

    applist_is_install_daraz = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))).any()) 
   
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))].empty:
        applist_update_shopping_date_max_gap =-1
    else:
        applist_update_shopping_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains('daraz', case= False, na = False))|(applist.collect_app_package.str.contains('com.daraz.android', case= False, na = False)))]['up_time'].dt.date).apply(lambda x: x.days))

    applist_install_finance_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('Rocket', case= False, na = False))|(applist.collect_app_package.str.contains('com.dbbl.mbs.apps.main', case= False, na = False)))]['collect_app_name'].nunique() 
    applist_d0_install_finance_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains('Rocket', case= False, na = False))|(applist.collect_app_package.str.contains('com.dbbl.mbs.apps.main', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_finance_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains('Rocket', case= False, na = False))|(applist.collect_app_package.str.contains('com.dbbl.mbs.apps.main', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_finance_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains('Rocket', case= False, na = False))|(applist.collect_app_package.str.contains('com.dbbl.mbs.apps.main', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_finance_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains('Rocket', case= False, na = False))|(applist.collect_app_package.str.contains('com.dbbl.mbs.apps.main', case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_finance_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains('Rocket', case= False, na = False))|(applist.collect_app_package.str.contains('com.dbbl.mbs.apps.main', case= False, na = False)))]['collect_app_name'].nunique()        

 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('Rocket', case= False, na = False))|(applist.collect_app_package.str.contains('Rocket', case= False, na = False))].empty:
        applist_install_finance_date_max_gap= -1
    else:
        applist_install_finance_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('Rocket', case= False, na = False))|(applist.collect_app_package.str.contains('com.dbbl.mbs.apps.main', case= False, na = False)))]['borrow_time'].dt.date -applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('Rocket', case= False, na = False))|(applist.collect_app_package.str.contains('com.dbbl.mbs.apps.main', case= False, na = False)))]['in_time'].dt.date).apply(lambda x: x.days))

    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('Rocket', case= False, na = False))].empty:
        applist_is_update_rocket = -1 
    else:
        applist_is_update_rocket = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('Rocket', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 

    applist_is_install_rocket = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('Rocket', case= False, na = False))|(applist.collect_app_package.str.contains('com.dbbl.mbs.apps.main', case= False, na = False)))).any()) 
   
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains('Rocket', case= False, na = False))|(applist.collect_app_package.str.contains('com.dbbl.mbs.apps.main', case= False, na = False)))].empty:
        applist_update_finance_date_max_gap =-1
    else:
        applist_update_finance_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains('Rocket', case= False, na = False))|(applist.collect_app_package.str.contains('com.dbbl.mbs.apps.main', case= False, na = False)))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains('Rocket', case= False, na = False))|(applist.collect_app_package.str.contains('com.dbbl.mbs.apps.main', case= False, na = False)))]['up_time'].dt.date).apply(lambda x: x.days))

    applist_install_job_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('LinkedIn', case= False, na = False))|(applist.collect_app_package.str.contains('com.linkedin.android' , case= False, na = False)))]['collect_app_name'].nunique() 
    applist_d0_install_job_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains('LinkedIn', case= False, na = False))|(applist.collect_app_package.str.contains('com.linkedin.android' , case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_job_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains('LinkedIn', case= False, na = False))|(applist.collect_app_package.str.contains('com.linkedin.android' , case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_job_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains('LinkedIn', case= False, na = False))|(applist.collect_app_package.str.contains('com.linkedin.android' , case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_job_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains('LinkedIn', case= False, na = False))|(applist.collect_app_package.str.contains('com.linkedin.android' , case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_job_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains('LinkedIn', case= False, na = False))|(applist.collect_app_package.str.contains('com.linkedin.android' , case= False, na = False)))]['collect_app_name'].nunique()        

 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('LinkedIn', case= False, na = False))|(applist.collect_app_package.str.contains('LinkedIn', case= False, na = False))].empty:
        applist_install_job_date_max_gap= -1
    else:
        applist_install_job_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('LinkedIn', case= False, na = False))|(applist.collect_app_package.str.contains('com.linkedin.android' , case= False, na = False)))]['borrow_time'].dt.date -applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('LinkedIn', case= False, na = False))|(applist.collect_app_package.str.contains('com.linkedin.android' , case= False, na = False)))]['in_time'].dt.date).apply(lambda x: x.days))

    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('LinkedIn', case= False, na = False))].empty:
        applist_is_update_job = -1 
    else:
        applist_is_update_job = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains('LinkedIn', case= False, na = False))&(applist.up_time > applist.in_time)).any()) 

    applist_is_install_job = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains('LinkedIn', case= False, na = False))|(applist.collect_app_package.str.contains('com.linkedin.android' , case= False, na = False)))).any()) 
   
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains('LinkedIn', case= False, na = False))|(applist.collect_app_package.str.contains('com.linkedin.android' , case= False, na = False)))].empty:
        applist_update_job_date_max_gap =-1
    else:
        applist_update_job_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains('LinkedIn', case= False, na = False))|(applist.collect_app_package.str.contains('com.linkedin.android' , case= False, na = False)))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains('LinkedIn', case= False, na = False))|(applist.collect_app_package.str.contains('com.linkedin.android' , case= False, na = False)))]['up_time'].dt.date).apply(lambda x: x.days))

    entertain_words = r'Toffee|CapCut|Tiktok' 
    applist_install_entertain_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(entertain_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.lemon.lvoverseas' , case= False, na = False))|(applist.collect_app_package.str.contains('com.banglalink.toffee' , case= False, na = False)))]['collect_app_name'].nunique() 
    applist_d0_install_entertain_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains(entertain_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.lemon.lvoverseas' , case= False, na = False))|(applist.collect_app_package.str.contains('com.banglalink.toffee' , case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_entertain_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains(entertain_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.lemon.lvoverseas' , case= False, na = False))|(applist.collect_app_package.str.contains('com.banglalink.toffee' , case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_entertain_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains(entertain_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.lemon.lvoverseas' , case= False, na = False))|(applist.collect_app_package.str.contains('com.banglalink.toffee' , case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_entertain_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains(entertain_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.lemon.lvoverseas' , case= False, na = False))|(applist.collect_app_package.str.contains('com.banglalink.toffee' , case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_entertain_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains(entertain_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.lemon.lvoverseas' , case= False, na = False))|(applist.collect_app_package.str.contains('com.banglalink.toffee' , case= False, na = False)))]['collect_app_name'].nunique()        

 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains(entertain_words, case= False, na = False))|(applist.collect_app_package.str.contains(entertain_words, case= False, na = False))].empty:
        applist_install_entertain_date_max_gap= -1
    else:
        applist_install_entertain_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(entertain_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.lemon.lvoverseas' , case= False, na = False))|(applist.collect_app_package.str.contains('com.banglalink.toffee' , case= False, na = False)))]['borrow_time'].dt.date -applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(entertain_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.lemon.lvoverseas' , case= False, na = False))|(applist.collect_app_package.str.contains('com.banglalink.toffee' , case= False, na = False)))]['in_time'].dt.date).apply(lambda x: x.days))

    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains(entertain_words, case= False, na = False))].empty:
        applist_is_update_entertain = -1 
    else:
        applist_is_update_entertain = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains(entertain_words, case= False, na = False))&(applist.up_time > applist.in_time)).any()) 

    applist_is_install_entertain = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(entertain_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.lemon.lvoverseas' , case= False, na = False))|(applist.collect_app_package.str.contains('com.banglalink.toffee' , case= False, na = False)))).any()) 
   
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains(entertain_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.lemon.lvoverseas' , case= False, na = False))|(applist.collect_app_package.str.contains('com.banglalink.toffee' , case= False, na = False)))].empty:
        applist_update_entertain_date_max_gap =-1
    else:
        applist_update_entertain_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains(entertain_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.lemon.lvoverseas' , case= False, na = False))|(applist.collect_app_package.str.contains('com.banglalink.toffee' , case= False, na = False)))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains(entertain_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.lemon.lvoverseas' , case= False, na = False))|(applist.collect_app_package.str.contains('com.banglalink.toffee' , case= False, na = False)))]['up_time'].dt.date).apply(lambda x: x.days))
#  游戏类  
    game_words = 'Candy Crush Saga'  
    # | 'com.king.candycrushsaga'
     
    applist_install_game_cnt =  applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(game_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.king.candycrushsaga' , case= False, na = False)))]['collect_app_name'].nunique() 
    applist_d0_install_game_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date == applist.in_time.dt.date)&((applist.collect_app_name.str.contains(game_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.king.candycrushsaga' , case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d3_install_game_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(3,'D'))&((applist.collect_app_name.str.contains(game_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.king.candycrushsaga' , case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d7_install_game_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(7,'D'))&((applist.collect_app_name.str.contains(game_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.king.candycrushsaga' , case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d14_install_game_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(14,'D'))&((applist.collect_app_name.str.contains(game_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.king.candycrushsaga' , case= False, na = False)))]['collect_app_name'].nunique()        
    applist_d30_install_game_cnt = applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.borrow_time.dt.date <= applist.in_time.dt.date + np.timedelta64(30,'D'))&((applist.collect_app_name.str.contains(game_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.king.candycrushsaga' , case= False, na = False)))]['collect_app_name'].nunique()        

 
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains(game_words, case= False, na = False))|(applist.collect_app_package.str.contains(game_words, case= False, na = False))].empty:
        applist_install_game_date_max_gap= -1
    else:
        applist_install_game_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(game_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.king.candycrushsaga' , case= False, na = False)))]['borrow_time'].dt.date -applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(game_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.king.candycrushsaga' , case= False, na = False)))]['in_time'].dt.date).apply(lambda x: x.days))

    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains(game_words, case= False, na = False))].empty:
        applist_is_update_game = -1 
    else:
        applist_is_update_game = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.collect_app_name.str.contains(game_words, case= False, na = False))&(applist.up_time > applist.in_time)).any()) 

    applist_is_install_game = int(((applist.app_type ==0 )&(applist.in_time > '2019-06-01')&((applist.collect_app_name.str.contains(game_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.king.candycrushsaga' , case= False, na = False)))).any()) 
   
    if applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains(game_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.king.candycrushsaga' , case= False, na = False)))].empty:
        applist_update_game_date_max_gap =-1
    else:
        applist_update_game_date_max_gap = np.max((applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains(game_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.lemon.lvoverseas' , case= False, na = False)))]['borrow_time'].dt.date - applist.loc[(applist.app_type ==0 )&(applist.in_time > '2019-06-01')&(applist.up_time > applist.in_time)&((applist.collect_app_name.str.contains(game_words, case= False, na = False))|(applist.collect_app_package.str.contains('com.king.candycrushsaga' , case= False, na = False)))]['up_time'].dt.date).apply(lambda x: x.days))






    data = {'order_id': order_id, 'applist_cnt':applist_cnt,
            'applist_system_cnt':applist_system_cnt, 'applist_preinstall_cnt':applist_preinstall_cnt,
            'applist_install_cnt':applist_install_cnt,'applist_update_cnt':applist_update_cnt,
            'applist_install_google_cnt':applist_install_google_cnt,'applist_install_mail_cnt':applist_install_mail_cnt,
            'applist_install_office_cnt':applist_install_office_cnt,'applist_d0_install_cnt':applist_d0_install_cnt,
            'applist_d3_install_cnt':applist_d3_install_cnt, 'applist_d7_install_cnt':applist_d7_install_cnt,
            'applist_d14_install_cnt':applist_d14_install_cnt,'applist_d30_install_cnt':applist_d30_install_cnt,
            'applist_d0_update_cnt':applist_d0_update_cnt,'applist_d3_update_cnt':applist_d3_update_cnt,
            'applist_d7_update_cnt':applist_d7_update_cnt, 'applist_d14_update_cnt':applist_d14_update_cnt,
            'applist_d30_update_cnt':applist_d30_update_cnt,'applist_install_xjd_cnt':applist_install_xjd_cnt,
            'applist_d0_install_xjd_cnt':applist_d0_install_xjd_cnt,'applist_d3_install_xjd_cnt':applist_d3_install_xjd_cnt,
            'applist_d7_install_xjd_cnt':applist_d7_install_xjd_cnt,'applist_d14_install_xjd_cnt':applist_d14_install_xjd_cnt,
            'applist_d30_install_xjd_cnt':applist_d30_install_xjd_cnt,
            'applist_update_xjd_cnt':applist_update_xjd_cnt, 'applist_is_install_whatsapp':applist_is_install_whatsapp,
            'applist_d0_update_xjd_cnt':applist_d0_update_xjd_cnt,
            'applist_d3_update_xjd_cnt':applist_d3_update_xjd_cnt,'applist_d7_update_xjd_cnt':applist_d7_update_xjd_cnt,
            'applist_d14_update_xjd_cnt':applist_d14_update_xjd_cnt,'applist_d30_update_xjd_cnt':applist_d30_update_xjd_cnt,
            'applist_install_bank_cnt':applist_install_bank_cnt,'applist_d0_install_bank_cnt':applist_d0_install_bank_cnt,
            'applist_d3_install_bank_cnt':applist_d3_install_bank_cnt,'applist_d7_install_bank_cnt':applist_d7_install_bank_cnt,
            'applist_d14_install_bank_cnt':applist_d14_install_bank_cnt,'applist_d30_install_bank_cnt':applist_d30_install_bank_cnt,
            'applist_update_bank_cnt':applist_update_bank_cnt,'applist_d0_update_bank_cnt':applist_d0_update_bank_cnt,
            'applist_d3_update_bank_cnt':applist_d3_update_bank_cnt,'applist_d7_update_bank_cnt':applist_d7_update_bank_cnt,
            'applist_d14_update_bank_cnt':applist_d14_update_bank_cnt,'applist_d30_update_bank_cnt':applist_d30_update_bank_cnt,
            'applist_install_wallet_cnt':applist_install_wallet_cnt,'applist_d0_install_wallet_cnt':applist_d0_install_wallet_cnt,
            'applist_d3_install_wallet_cnt':applist_d3_install_wallet_cnt,'applist_d7_install_wallet_cnt':applist_d7_install_wallet_cnt,
            'applist_d14_install_wallet_cnt':applist_d14_install_wallet_cnt,'applist_d30_install_wallet_cnt':applist_d30_install_wallet_cnt,
            'applist_update_wallet_cnt':applist_update_wallet_cnt,'applist_update_wallet_cnt':applist_update_wallet_cnt,
            'applist_d0_update_wallet_cnt':applist_d0_update_wallet_cnt,'applist_d3_update_wallet_cnt':applist_d3_update_wallet_cnt,
            'applist_d7_update_wallet_cnt':applist_d7_update_wallet_cnt,'applist_d14_update_wallet_cnt':applist_d14_update_wallet_cnt,
            'applist_d30_update_wallet_cnt':applist_d30_update_wallet_cnt,'applist_install_pay_cnt':applist_install_pay_cnt,
            'applist_d0_install_pay_cnt':applist_d0_install_pay_cnt,'applist_d3_install_pay_cnt':applist_d3_install_pay_cnt,
            'applist_d7_install_pay_cnt':applist_d7_install_pay_cnt,'applist_d14_install_pay_cnt':applist_d14_install_pay_cnt,
            'applist_d30_install_pay_cnt':applist_d30_install_pay_cnt,'applist_update_pay_cnt':applist_update_pay_cnt,
            'applist_d0_update_pay_cnt':applist_d0_update_pay_cnt,'applist_d3_update_pay_cnt':applist_d3_update_pay_cnt,
            'applist_d7_update_pay_cnt':applist_d7_update_pay_cnt,'applist_d14_update_pay_cnt':applist_d14_update_pay_cnt,
            'applist_d30_update_pay_cnt':applist_d30_update_pay_cnt,'applist_install_casino_cnt':applist_install_casino_cnt,'applist_d0_install_casino_cnt':applist_d0_install_casino_cnt,'applist_d3_install_casino_cnt':applist_d3_install_casino_cnt,'applist_d7_install_casino_cnt':applist_d7_install_casino_cnt,
            'applist_d14_install_casino_cnt':applist_d14_install_casino_cnt,'applist_d30_install_casino_cnt':applist_d30_install_casino_cnt,'applist_update_casino_cnt':applist_update_casino_cnt,'applist_d0_update_casino_cnt':applist_d0_update_casino_cnt,'applist_d3_update_casino_cnt':applist_d3_update_casino_cnt,
            'applist_d7_update_casino_cnt':applist_d7_update_casino_cnt,'applist_d14_update_casino_cnt':applist_d14_update_casino_cnt,'applist_d30_update_casino_cnt':applist_d30_update_casino_cnt,'applist_install_fake_cnt':applist_install_fake_cnt,'applist_d0_install_fake_cnt':applist_d0_install_fake_cnt,'applist_d3_install_fake_cnt':applist_d3_install_fake_cnt,'applist_d7_install_fake_cnt':applist_d7_install_fake_cnt,
            'applist_d14_install_fake_cnt':applist_d14_install_fake_cnt,'applist_d30_install_fake_cnt':applist_d30_install_fake_cnt,'applist_install_gcash_cnt':applist_install_gcash_cnt,'applist_d0_install_gcash_cnt':applist_d0_install_gcash_cnt,'applist_d3_install_gcash_cnt':applist_d3_install_gcash_cnt,'applist_d7_install_gcash_cnt':applist_d7_install_gcash_cnt,'applist_d14_install_gcash_cnt':applist_d14_install_gcash_cnt,
            'applist_d30_install_gcash_cnt':applist_d30_install_gcash_cnt,'applist_install_maya_cnt':applist_install_maya_cnt,'applist_d0_install_maya_cnt':applist_d0_install_maya_cnt,'applist_d3_install_maya_cnt':applist_d3_install_maya_cnt,'applist_d7_install_maya_cnt':applist_d7_install_maya_cnt,'applist_d14_install_maya_cnt':applist_d14_install_maya_cnt,'applist_d30_install_maya_cnt':applist_d30_install_maya_cnt,'applist_install_mabiliscash_cnt':applist_install_mabiliscash_cnt,
            'applist_d0_install_mabiliscash_cnt':applist_d0_install_mabiliscash_cnt,'applist_d3_install_mabiliscash_cnt':applist_d3_install_mabiliscash_cnt,'applist_d7_install_mabiliscash_cnt':applist_d7_install_mabiliscash_cnt,'applist_d14_install_mabiliscash_cnt':applist_d14_install_mabiliscash_cnt,'applist_d30_install_mabiliscash_cnt':applist_d30_install_mabiliscash_cnt,'applist_install_truemoney_cnt':applist_install_truemoney_cnt,'applist_d0_install_truemoney_cnt':applist_d0_install_truemoney_cnt,
            'applist_d3_install_truemoney_cnt':applist_d3_install_truemoney_cnt,'applist_d3_install_truemoney_cnt':applist_d3_install_truemoney_cnt,'applist_d14_install_truemoney_cnt':applist_d14_install_truemoney_cnt,'applist_d30_install_truemoney_cnt':applist_d30_install_truemoney_cnt,'applist_install_scb_cnt':applist_install_scb_cnt,'applist_d0_install_scb_cnt':applist_d0_install_scb_cnt,'applist_d3_install_scb_cnt':applist_d3_install_scb_cnt,'applist_d7_install_scb_cnt':applist_d7_install_scb_cnt,
            'applist_d14_install_scb_cnt':applist_d14_install_scb_cnt,'applist_d30_install_scb_cnt':applist_d30_install_scb_cnt,'applist_install_momo_cnt':applist_install_momo_cnt,'applist_d0_install_momo_cnt':applist_d0_install_momo_cnt,'applist_d3_install_momo_cnt':applist_d3_install_momo_cnt,'applist_d7_install_momo_cnt':applist_d7_install_momo_cnt,'applist_d14_install_momo_cnt':applist_d14_install_momo_cnt,'applist_d30_install_momo_cnt':applist_d30_install_momo_cnt,'applist_install_facebook_cnt':applist_install_facebook_cnt,
            'applist_d0_install_facebook_cnt':applist_d0_install_facebook_cnt,'applist_d3_install_facebook_cnt':applist_d3_install_facebook_cnt,'applist_d7_install_facebook_cnt':applist_d7_install_facebook_cnt,'applist_d14_install_facebook_cnt':applist_d14_install_facebook_cnt,'applist_d30_install_facebook_cnt':applist_d30_install_facebook_cnt,'applist_install_messenger_cnt':applist_install_messenger_cnt,'applist_d0_install_messenger_cnt':applist_d0_install_messenger_cnt,'applist_d3_install_messenger_cnt':applist_d3_install_messenger_cnt,
            'applist_d7_install_messenger_cnt':applist_d7_install_messenger_cnt,'applist_d14_install_messenger_cnt':applist_d14_install_messenger_cnt,'applist_d30_install_messenger_cnt':applist_d30_install_messenger_cnt,'applist_install_instagram_cnt':applist_install_instagram_cnt,'applist_d0_install_instagram_cnt':applist_d0_install_instagram_cnt,'applist_d3_install_instagram_cnt':applist_d3_install_instagram_cnt,'applist_d7_install_instagram_cnt':applist_d7_install_instagram_cnt,'applist_d14_install_instagram_cnt':applist_d14_install_instagram_cnt,
            'applist_d30_install_instagram_cnt':applist_d30_install_instagram_cnt,'applist_install_telegram_cnt':applist_install_telegram_cnt,'applist_d0_install_telegram_cnt':applist_d0_install_telegram_cnt,'applist_d3_install_telegram_cnt':applist_d3_install_telegram_cnt,'applist_d7_install_telegram_cnt':applist_d7_install_telegram_cnt,'applist_d14_install_telegram_cnt':applist_d14_install_telegram_cnt,'applist_d30_install_telegram_cnt':applist_d30_install_telegram_cnt,'applist_install_whatsapp_cnt':applist_install_whatsapp_cnt,
            'applist_d0_install_whatsapp_cnt':applist_d0_install_whatsapp_cnt,'applist_d3_install_whatsapp_cnt':applist_d3_install_whatsapp_cnt,'applist_d7_install_whatsapp_cnt':applist_d7_install_whatsapp_cnt,'applist_d14_install_whatsapp_cnt':applist_d14_install_whatsapp_cnt,'applist_d30_install_whatsapp_cnt':applist_d30_install_whatsapp_cnt,'applist_install_zalo_cnt':applist_install_zalo_cnt,'applist_d0_install_zalo_cnt':applist_d0_install_zalo_cnt,'applist_d3_install_zalo_cnt':applist_d3_install_zalo_cnt,'applist_d7_install_zalo_cnt':applist_d7_install_zalo_cnt,
            'applist_d14_install_zalo_cnt':applist_d14_install_zalo_cnt,'applist_d30_install_zalo_cnt':applist_d30_install_zalo_cnt,'applist_install_tiktok_cnt':applist_install_tiktok_cnt,'applist_d0_install_tiktok_cnt':applist_d0_install_tiktok_cnt,'applist_d3_install_tiktok_cnt':applist_d3_install_tiktok_cnt,'applist_d7_install_tiktok_cnt':applist_d7_install_tiktok_cnt,'applist_d14_install_tiktok_cnt':applist_d14_install_tiktok_cnt,'applist_d30_install_tiktok_cnt':applist_d30_install_tiktok_cnt,'applist_install_imported_cnt':applist_install_imported_cnt,'applist_d0_install_imported_cnt':applist_d0_install_imported_cnt,
            'applist_d3_install_imported_cnt':applist_d3_install_imported_cnt,'applist_d7_install_imported_cnt':applist_d7_install_imported_cnt,'applist_d14_install_imported_cnt':applist_d14_install_imported_cnt,'applist_d30_install_imported_cnt':applist_d30_install_imported_cnt,'applist_daily_max':applist_daily_max,'applist_d0_daily_max':applist_d0_daily_max,'applist_d3_daily_max':applist_d3_daily_max,'applist_d7_daily_max':applist_d7_daily_max,'applist_d14_daily_max':applist_d14_daily_max,'applist_d30_daily_max':applist_d30_daily_max,
            'applist_install_date_max_gap':applist_install_date_max_gap,'applist_is_update_grabfood':applist_is_update_grabfood,'applist_is_update_foodpanda':applist_is_update_foodpanda,
            'applist_is_update_zomato':applist_is_update_zomato,'applist_is_update_swiggy':applist_is_update_swiggy,
            'applist_install_xjd_date_max_gap':applist_install_xjd_date_max_gap,
            'applist_install_bank_date_max_gap':applist_install_bank_date_max_gap,
            'applist_install_wallet_date_max_gap':applist_install_wallet_date_max_gap,
            'applist_install_pay_date_max_gap':applist_install_pay_date_max_gap, 
            'applist_install_casino_date_max_gap':applist_install_casino_date_max_gap,
            'applist_update_date_max_gap':applist_update_date_max_gap,'applist_update_xjd_date_max_gap':applist_update_xjd_date_max_gap,
            'applist_update_bank_date_max_gap':applist_update_bank_date_max_gap,'applist_update_wallet_date_max_gap':applist_update_wallet_date_max_gap,
            'applist_update_pay_date_max_gap':applist_update_pay_date_max_gap,'applist_update_casino_date_max_gap':applist_update_casino_date_max_gap,
            'applist_install_whatsapp_date_max_gap':applist_install_whatsapp_date_max_gap,'applist_install_facebook_date_max_gap':applist_install_facebook_date_max_gap,
            'applist_install_messenger_date_max_gap':applist_install_messenger_date_max_gap,'applist_install_telegram_date_max_gap':applist_install_telegram_date_max_gap,
            'applist_install_wechat_date_max_gap':applist_install_wechat_date_max_gap,
            'applist_install_instagram_date_max_gap':applist_install_instagram_date_max_gap,
            'applist_install_tiktok_date_max_gap': applist_install_tiktok_date_max_gap, 'applist_install_truecaller_date_max_gap':applist_install_truecaller_date_max_gap,
            'applist_install_shopee_date_max_gap':applist_install_shopee_date_max_gap,'applist_install_lazada_date_max_gap':applist_install_lazada_date_max_gap,'applist_install_flipkart_date_max_gap':applist_install_flipkart_date_max_gap,
            'applist_install_grabfood_date_max_gap':applist_install_grabfood_date_max_gap,'applist_install_swiggy_date_max_gap':applist_install_swiggy_date_max_gap,'applist_is_install_gmail':applist_is_install_gmail,'applist_is_install_yahoomail':applist_is_install_yahoomail,
            'applist_is_install_facebook':applist_is_install_facebook,'applist_is_install_messenger':applist_is_install_messenger,'applist_is_install_telegram':applist_is_install_telegram,'applist_is_install_wechat':applist_is_install_wechat,
            'applist_is_install_instagram':applist_is_install_instagram,'applist_is_install_tiktok':applist_is_install_tiktok,'applist_is_install_truecaller':applist_is_install_truecaller,'applist_is_install_shopee':applist_is_install_shopee,
            'applist_is_install_lazada':applist_is_install_lazada,'applist_is_install_flipkart':applist_is_install_flipkart,'applist_is_install_foodpanda':applist_is_install_foodpanda,'applist_is_install_zomato':applist_is_install_zomato,'applist_is_install_swiggy':applist_is_install_swiggy,
            'applist_is_update_gmail':applist_is_update_gmail,'applist_is_update_yahoomail':applist_is_update_yahoomail,'applist_is_update_microffice':applist_is_update_microffice,'applist_is_update_wpsoffice':applist_is_update_wpsoffice,'applist_is_update_whatsapp':applist_is_update_whatsapp,
            'applist_is_update_telegram':applist_is_update_telegram,'applist_is_update_wechat':applist_is_update_wechat,'applist_is_update_instagram':applist_is_update_instagram,'applist_is_update_tiktok':applist_is_update_tiktok,'applist_is_update_shopee':applist_is_update_shopee,'applist_is_update_lazada':applist_is_update_lazada,
            'applist_is_update_flipkart':applist_is_update_flipkart, 'applist_install_nagad_cnt':applist_install_nagad_cnt, 'applist_d0_install_nagad_cnt':applist_d0_install_nagad_cnt,
            'applist_d3_install_nagad_cnt':applist_d3_install_nagad_cnt, 'applist_d7_install_nagad_cnt':applist_d7_install_nagad_cnt,'applist_d14_install_nagad_cnt':applist_d14_install_nagad_cnt, 
            'applist_d30_install_nagad_cnt':applist_d30_install_nagad_cnt, 'applist_install_nagad_date_max_gap':applist_install_nagad_date_max_gap,'applist_is_update_nagad':applist_is_update_nagad,
            'applist_is_install_nagad':applist_is_install_nagad, 'applist_update_nagad_date_max_gap':applist_update_nagad_date_max_gap, 'applist_install_hospital_cnt':applist_install_hospital_cnt,
            'applist_d0_install_hospital_cnt':applist_d0_install_hospital_cnt, 'applist_d3_install_hospital_cnt':applist_d3_install_hospital_cnt,'applist_d7_install_hospital_cnt':applist_d7_install_hospital_cnt,
            'applist_d14_install_hospital_cnt':applist_d14_install_hospital_cnt, 'applist_d30_install_hospital_cnt':applist_d30_install_hospital_cnt, 'applist_install_hospital_date_max_gap':applist_install_hospital_date_max_gap,
            'applist_is_update_mygp':applist_is_update_mygp,'applist_is_install_mygp':applist_is_install_mygp, 
            'applist_update_hospital_date_max_gap':applist_update_hospital_date_max_gap, 'applist_install_shopping_cnt':applist_install_shopping_cnt,'applist_d0_install_shopping_cnt':applist_d0_install_shopping_cnt,
            'applist_d3_install_shopping_cnt':applist_d3_install_shopping_cnt,'applist_d7_install_shopping_cnt':applist_d7_install_shopping_cnt, 'applist_d14_install_shopping_cnt':applist_d14_install_shopping_cnt, 
            'applist_d30_install_shopping_cnt':applist_d30_install_shopping_cnt, 'applist_install_shopping_date_max_gap':applist_install_shopping_date_max_gap, 'applist_is_update_daraz':applist_is_update_daraz, 
            'applist_is_install_daraz':applist_is_install_daraz, 'applist_update_shopping_date_max_gap':applist_update_shopping_date_max_gap,
            'applist_install_finance_cnt':applist_install_finance_cnt, 'applist_d0_install_finance_cnt':applist_d0_install_finance_cnt,
            'applist_d3_install_finance_cnt':applist_d3_install_finance_cnt, 'applist_d7_install_finance_cnt':applist_d7_install_finance_cnt,'applist_d14_install_finance_cnt':applist_d14_install_finance_cnt, 
            'applist_d30_install_finance_cnt':applist_d30_install_finance_cnt, 'applist_install_finance_date_max_gap':applist_install_finance_date_max_gap,'applist_is_update_rocket':applist_is_update_rocket,
            'applist_is_install_rocket':applist_is_install_rocket, 'applist_update_finance_date_max_gap':applist_update_finance_date_max_gap,
            'applist_install_job_cnt':applist_install_job_cnt, 'applist_d0_install_job_cnt':applist_d0_install_job_cnt,
            'applist_d3_install_job_cnt':applist_d3_install_job_cnt, 'applist_d7_install_job_cnt':applist_d7_install_job_cnt,
            'applist_d14_install_job_cnt':applist_d14_install_job_cnt, 
            'applist_d30_install_job_cnt':applist_d30_install_job_cnt, 'applist_install_job_date_max_gap':applist_install_job_date_max_gap,
            'applist_is_update_job':applist_is_update_job,
            'applist_is_install_job':applist_is_install_job, 'applist_update_job_date_max_gap':applist_update_job_date_max_gap,
            'applist_install_entertain_cnt':applist_install_entertain_cnt, 'applist_d0_install_entertain_cnt':applist_d0_install_entertain_cnt,
            'applist_d3_install_entertain_cnt':applist_d3_install_entertain_cnt, 'applist_d7_install_entertain_cnt':applist_d7_install_entertain_cnt,
            'applist_d14_install_entertain_cnt':applist_d14_install_entertain_cnt, 
            'applist_d30_install_entertain_cnt':applist_d30_install_entertain_cnt, 'applist_install_entertain_date_max_gap':applist_install_entertain_date_max_gap,
            'applist_is_update_entertain':applist_is_update_entertain,
            'applist_is_install_entertain':applist_is_install_entertain, 'applist_update_entertain_date_max_gap':applist_update_entertain_date_max_gap,
            'applist_install_game_cnt':applist_install_game_cnt, 'applist_d0_install_game_cnt':applist_d0_install_game_cnt,
            'applist_d3_install_game_cnt':applist_d3_install_game_cnt, 'applist_d7_install_game_cnt':applist_d7_install_game_cnt,
            'applist_d14_install_game_cnt':applist_d14_install_game_cnt, 
            'applist_d30_install_game_cnt':applist_d30_install_game_cnt, 'applist_install_game_date_max_gap':applist_install_game_date_max_gap,
            'applist_is_update_game':applist_is_update_game,
            'applist_is_install_game':applist_is_install_game, 'applist_update_game_date_max_gap':applist_update_game_date_max_gap

            

            }
    applist_df = pd.DataFrame([data])
    applist_df.fillna(-1,inplace=True)
    return applist_df